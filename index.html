<!DOCTYPE html>
<html>
<head>
  <title>Study Buddy</title>
  <style>
    body { font-family: Arial; padding: 20px; }
    h2 { margin-bottom: 10px; }
    button { margin-top: 10px; padding: 8px 12px; font-size: 16px; }
    pre { background: #f3f3f3; padding: 10px; margin-top: 20px; white-space: pre-wrap; }
  </style>
</head>
<body>
  <h2>ðŸ“¸ Take a Picture of Your Notes</h2>

  <input type="file" id="photo" accept="image/*" capture="environment">
  <br>
  <button onclick="send()">Help Me Study</button>

  <pre id="output"></pre>

  <script>
    async function send() {
      const file = document.getElementById("photo").files[0];
      if (!file) {
        alert("Take a picture first!");
        return;
      }

      const reader = new FileReader();
      reader.onload = async () => {
        const base64 = reader.result.split(",")[1];

        try {
          const response = await fetch("study-helper.sienawlewis.workers.dev", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({
              model: "gpt-4.1-mini",
              input: [
                {
                  role: "user",
                  content: [
                    { type: "input_text", text: "Read these notes and explain them simply." },
                    { type: "input_image", image_base64: base64 }
                  ]
                }
              ]
            })
          });

          const data = await response.json();
          document.getElementById("output").textContent = data.output_text || "No response from AI.";

        } catch (err) {
          document.getElementById("output").textContent = "Error: " + err.message;
        }
      };

      reader.readAsDataURL(file);
    }
  </script>
</body>
</html>
